<div class="d-flex flex-column flex-md-row gap-4 mt-3 px-3">
  <!-- Sidebar -->
  <div class="p-3" style="width: 100%; max-width: 18rem;">
    <app-sidebar (filterChanged)="onFilterChange($event)"></app-sidebar>
  </div>

  <div class="flex-grow-1 p-3">
    <!-- Search & Filter -->
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-stretch gap-3 mb-4">
      <input
        type="text"
        class="form-control"
        placeholder="Search..."
        [(ngModel)]="searchQuery"
        (input)="onSearchChange()" />

      <div class="dropdown">
        <button class="btn btn-dark dropdown-toggle w-100" type="button" data-bs-toggle="dropdown">
          {{ selectedCategory }}
        </button>
        <ul class="dropdown-menu dropdown-menu-end custom-dropdown">
          <li><a class="dropdown-item" (click)="onFilterChange('All')" style="cursor: pointer">All</a></li>
          <li><a class="dropdown-item" (click)="onFilterChange('Sports')" style="cursor: pointer">Sports</a></li>
          <li><a class="dropdown-item" (click)="onFilterChange('Cricket')" style="cursor: pointer">Cricket</a></li>
          <li><a class="dropdown-item" (click)="onFilterChange('Fashion')" style="cursor: pointer">Fashion</a></li>
          <li><a class="dropdown-item" (click)="onFilterChange('Technology')" style="cursor: pointer">Technology</a></li>
          <li><a class="dropdown-item" (click)="onFilterChange('Health')" style="cursor: pointer">Health</a></li>
        </ul>
      </div>
    </div>

    <!-- Grid or Carousel View-->
    <div class="d-flex justify-content-end mb-3">
      <button class="btn btn-dark" (click)="toggleCarouselView()">
        {{ showCarousel ? 'Switch to Grid View' : 'Switch to Carousel View' }}
      </button>
    </div>
    <!-- Carousel -->
    <div *ngIf="showCarousel">
      <div id="carouselExample" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner">
          @for (chunk of blogChunks; track $index) {
            <div class="carousel-item" [class.active]="$index === 0">
              <div class="d-flex justify-content-center gap-3 flex-wrap">
                @for (blog of chunk; track blog.id) {
                  <div class="card" style="width: 18rem;">
                    <img
                      [src]="blog.imageUrl || 'https://via.placeholder.com/286x180'"
                      class="card-img-top"
                      alt="Blog Image"
                      style="height: 12rem; object-fit: cover;" />
                    <div class="card-body">
                      <h5 class="card-title">{{ blog.title }}</h5>
                      <p class="card-text text-truncate">{{ blog.content }}</p>
                      <button class="btn btn-primary" (click)="showDetails(blog.id)">
                        Read More
                      </button>
                    </div>
                  </div>
                }
              </div>
            </div>
          }
        </div>

        <!-- Carousel controls -->
        <!-- Prev Button -->
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
          <span class="carousel-control-prev-icon custom-carousel-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Previous</span>
        </button>

        <!-- Next Button -->
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
          <span class="carousel-control-next-icon custom-carousel-icon" aria-hidden="true"></span>
          <span class="visually-hidden">Next</span>
        </button>

      </div>
    </div>

    <!-- Grid View -->
    @if(!showCarousel){
      <div class="d-flex flex-wrap justify-content-center gap-3">
        @for (blog of filteredBlogs; track blog.id) {
          <div class="card" style="width: 18rem;">
            <img [src]="blog.imageUrl || 'https://via.placeholder.com/286x180'" class="card-img-top" style="height: 12rem; object-fit: cover;"  alt=""/>
            <div class="card-body">
              <h5 class="card-title">{{ blog.title }}</h5>
              <p class="card-text text-truncate">{{ blog.content }}</p>
              <button class="btn btn-primary" (click)="showDetails(blog.id)">Read More</button>
            </div>
          </div>
        }
      </div>
    }
  </div>
</div>
